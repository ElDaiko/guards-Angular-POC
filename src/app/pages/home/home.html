<h1>Home (PÃºblica)</h1>

<div class="auth-controls">
  <div class="auth-status">
    <p>
      Estado:
      <span [class]="isLoggedIn ? 'logged-in' : 'logged-out'">
        {{ isLoggedIn ? 'Autenticado' : 'No autenticado' }}
      </span>
      @if (isLoggedIn) { | Rol:
      <span class="role-badge" [class.admin]="isAdmin" [class.user]="isUser">
        {{ userRole.toUpperCase() }}
      </span>
      }
    </p>
  </div>

  <div class="button-group">
    <button (click)="toggleAuth()" class="auth-button">
      {{ isLoggedIn ? 'Cerrar SesiÃ³n' : 'Iniciar SesiÃ³n' }}
    </button>

    @if (isLoggedIn) {
    <button (click)="toggleRole()" class="role-button">
      Cambiar a {{ isAdmin ? 'USER' : 'ADMIN' }}
    </button>
    }
  </div>
</div>

<!-- ğŸŒŸ NUEVA SECCIÃ“N PARA DEMOSTRAR canMatch ğŸŒŸ -->
<div class="canmatch-demo">
  <div class="demo-section">
    <div class="route-configs">
      <div class="config admin-config">
        <h4>ğŸ”´ ConfiguraciÃ³n 1 (Solo ADMIN)</h4>
        <div class="code-snippet">
          <code>
            {{'{'}} path: 'dashboard', component: AdminPanel, canMatch:
            [adminMatchGuard] {{'}'}}
          </code>
        </div>
      </div>

      <div class="config user-config">
        <h4>ğŸ”µ ConfiguraciÃ³n 2 (Solo USER)</h4>
        <div class="code-snippet">
          <code>
            {{'{'}} path: 'dashboard', component: UserDashboard, canMatch:
            [userMatchGuard] {{'}'}}
          </code>
        </div>
      </div>
    </div>

    <div class="current-state">
      <p><strong>Tu estado actual:</strong></p>
      <ul>
        <li>Autenticado: {{ isLoggedIn ? 'âœ… SÃ­' : 'âŒ No' }}</li>
        <li>Rol: {{ isLoggedIn ? userRole.toUpperCase() : 'NINGUNO' }}</li>
      </ul>
    </div>

    <div class="test-area">
      <h4>ğŸš€ Haz la prueba:</h4>
      <a [routerLink]="['/dashboard']" class="dashboard-link">
        ğŸ¯ Ir a /dashboard
      </a>

      <div class="prediction">
        @if (!isLoggedIn) {
        <p class="no-access">
          âŒ Ninguna configuraciÃ³n serÃ¡ considerada (no autenticado)
        </p>
        } @else if (isAdmin) {
        <p class="admin-access">
          ğŸ”´ Se usarÃ¡ la configuraciÃ³n de ADMIN â†’ AdminPanel
        </p>
        } @else if (isUser) {
        <p class="user-access">
          ğŸ”µ Se usarÃ¡ la configuraciÃ³n de USER â†’ UserDashboard
        </p>
        }
      </div>
    </div>
  </div>
</div>

<div class="test-instructions">
  <h2>ğŸ§ª CÃ³mo probar los Guards:</h2>

  <div class="step">
    <h3>1ï¸âƒ£ Probar canMatch y canActivate:</h3>
    <p>
      Con el estado actual (<strong
        >{{ isLoggedIn ? 'Autenticado' : 'No autenticado' }}</strong
      >):
    </p>
    <a [routerLink]="['/private']" class="test-link"> ğŸ”— Ir a /private </a>
    <p class="result-info">
      {{ isLoggedIn ? 'âœ… DeberÃ­as ver ambos guards permitir el acceso' : 'âŒ
      DeberÃ­as ver ambos guards denegar el acceso' }}
    </p>
  </div>

  <div class="step">
    <h3>2ï¸âƒ£ Probar canActivateChild:</h3>
    <p>Con el estado actual, intenta acceder directamente a:</p>
    <div class="child-test-links">
      <a [routerLink]="['/private/settings']" class="test-link">
        ğŸ”§ /private/settings
      </a>
      <a [routerLink]="['/private/profile']" class="test-link">
        ğŸ‘¤ /private/profile
      </a>
    </div>
    <p class="result-info">
      {{ isLoggedIn ? 'âœ… DeberÃ­as ver los 3 guards ejecutarse en orden' : 'âŒ
      Los guards deberÃ­an bloquear el acceso antes de llegar a la ruta hija' }}
    </p>
  </div>
</div>
